<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>Happy Birthday, Princess! 🎂🌈</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Poppins:wght@400;500&display=swap" rel="stylesheet" />
  <style>
    :root {
      --accent: #ffd1ea;
      --accent2: #ff68bc;
      --accent3: #8f8cff;
      --accent4: #64ffe7;
      --bg-gradient: radial-gradient(circle at 58% 43%, #fff5fa 0%, #ffd1ea 35%, #ff68bc 100%);
      --glass: rgba(255,255,255,0.85);
      --shadow: 0 4px 44px 0 rgba(251,93,173,0.11);
      --btn-gradient: linear-gradient(90deg, #ffd1ea 0%, #ff68bc 100%);
      --btn-gradient-hover: linear-gradient(92deg, #fff5fa 0%, #ff68bc 100%);
      --btn-shadow: 0 4px 20px #ff68bc44;
      --btn-shadow-hover: 0 6px 24px #ffd1ea88;
      --text-muted: #5a3453;
      --text-light: #bb63a7;
    }
    html, body {
      height: 100%;
      overflow-y: auto;
      margin: 0;
      padding: 0;
      -webkit-overflow-scrolling: touch;
      font-family: 'Poppins', sans-serif;
      background: var(--bg-gradient);
      color: var(--text-muted);
      overflow-x: hidden;
    }
    * {
      box-sizing: border-box;
    }
    body {
      min-height: 100vh;
      display: block;
    }
    #starry-intro {
      position: fixed;
      inset: 0;
      background: black;
      z-index: 9999;
      width: 100vw;
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      overflow: hidden;
    }
    #stars-bg {
      position: absolute;
      inset: 0;
      width: 100vw;
      height: 100vh;
      z-index: 0;
      pointer-events: none;
      display: block;
    }
    .star-content {
      z-index: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-width: 240px;
      width: 100vw;
      max-width: 96vw;
    }
    #typing-line {
      font-family: 'Playfair Display', serif;
      text-align: center;
      color: #fff;
      margin-bottom: 1.1rem;
      font-size: 2rem;
      font-weight: 700;
      min-height: 1.5em;
      max-width: 80vw;
      line-height: 1.2;
      word-break: break-word;
      white-space: pre-wrap;
    }
    @media (max-width: 900px) { #typing-line { font-size: 1.2rem; } }
    @media (max-width: 500px) { #typing-line { font-size: 1rem; } }
    #lights-btn {
      display: none;
      margin-top: 1.26rem;
      padding: 0.4em 1.25em;
      font-size: 1rem;
      border: none;
      border-radius: 1em;
      background: linear-gradient(90deg, #fff2e9, #f6afe7, #dce6ff 80%);
      color: #23252a;
      font-weight: 600;
      box-shadow: 0 3.5px 24px #fff2ea32;
      cursor: pointer;
      opacity: 0;
      transition: opacity 350ms, box-shadow 0.22s;
      user-select: none;
      letter-spacing: 0.025em;
    }
    #lights-btn:focus, #lights-btn:hover {
      box-shadow: 0 8px 32px #f6afe7cc;
      outline: none;
      filter: brightness(1.09);
    }
    .hearts-down, .hearts-up, .confetti {
      position: fixed;
      width: 100vw;
      height: 100vh;
      left: 0; top: 0;
      pointer-events: none;
      z-index: 10;
      overflow: visible;
      user-select: none;
    }
    .heart-down, .heart-up {
      position: absolute;
      width: 32px;
      height: 32px;
      opacity: 0.79;
      pointer-events: none;
    }
    .heart-down.pink svg, .heart-up.pink svg { fill: #ffb7da; }
    .heart-down.teal svg, .heart-up.teal svg { fill: #64ffe7; }
    .heart-down.violet svg, .heart-up.violet svg { fill: #8f8cff; }
    .heart-down svg, .heart-up svg { width: 100%; height: 100%; user-select:none; }
    @keyframes fallHeartsDown {
      0% { top: -40px; transform: scale(0.52) rotate(13deg);}
      20% { transform: scale(0.8) rotate(-8deg);}
      50% { transform: scale(1) rotate(-3deg);}
      100% { top: 110vh; opacity: 0.15; transform: scale(1.1) rotate(-29deg);}
    }
    @keyframes floatHeartsUp {
      0% { bottom: -40px; transform: scale(0.59) rotate(-12deg);}
      20% { transform: scale(0.83) rotate(7deg);}
      56% { transform: scale(1.09) rotate(3deg);}
      100% { bottom: 115vh; opacity: 0.16; transform: scale(1.15) rotate(29deg);}
    }
    .heart-down { animation: fallHeartsDown 11s linear infinite;}
    .heart-up { animation: floatHeartsUp 13s linear infinite;}
    .confetti-piece {
      position: absolute;
      width: 13px;
      height: 13px;
      border-radius: 4px;
      opacity: 0.93;
      animation: fallConfetti 6s linear infinite;
    }
    @keyframes fallConfetti {
      to { top: 106vh; transform: rotate(360deg);}
    }
    main {
      width: 100vw;
      min-height: 100vh;
      max-width: 820px;
      display: none;
      position: relative;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
      padding: 2rem 1rem 3rem 1rem; /* bottom padding for nav */
      align-items: center;
      justify-content: flex-start;
      z-index: 30;
      flex-direction: column;
    }
    .page {
      width: 100%;
      min-height: 100vh;
      position: relative;
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      opacity: 0;
      pointer-events: none;
      padding: 1rem 0 3rem 0; /* extra bottom padding */
      box-sizing: border-box;
      transition: opacity 0.6s;
    }
    .page.active {
      display: flex;
      opacity: 1;
      pointer-events: auto;
      z-index: 2;
    }
    .card-with-gradient-border {
      background: var(--glass);
      border-radius: 1.3rem;
      box-shadow: var(--shadow);
      padding: 2.4rem 2rem 3rem 2rem; /* extended bottom padding */
      width: 100%;
      max-width: 710px;
      color: var(--text-muted);
      text-align: center;
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 0 auto 2rem auto;
      backdrop-filter: blur(2px);
      word-wrap: break-word;
      overflow-wrap: break-word;
    }
    h1, h2 {
      font-family: 'Playfair Display', serif;
      font-size: 2.5rem;
      color: #ff68bc;
      margin-bottom: 1.15rem;
      text-shadow: 0 4px 13px #ffd1ea, 0 0px 36px #ffb7da66;
      letter-spacing: 0.03em;
      user-select: text;
    }
    p, .poem, .note-box {
      font-size: 1.13rem;
      line-height: 1.6;
      color: var(--text-muted);
      margin-bottom: 1.5rem;
      user-select: text;
      max-width: 100%;
      white-space: normal;
      word-break: break-word;
    }
    .note-box {
      background: rgba(255, 215, 235, 0.13);
      border-radius: 1rem;
      padding: 1.17rem;
      font-style: italic;
      letter-spacing: 0.018em;
    }
    .nav-buttons {
      display: flex;
      justify-content: center;
      gap: 1.1rem;
      flex-wrap: wrap;
      margin-top: auto;
      width: 100%;
      max-width: 420px;
    }
    button, #start-screen button {
      flex: 1 1 135px;
      padding: 1rem 2rem;
      border-radius: 3rem;
      border: none;
      background: var(--btn-gradient);
      box-shadow: var(--btn-shadow);
      color: #b3467a;
      font-weight: 700;
      font-size: 1.22rem;
      cursor: pointer;
      transition: all 0.16s;
      margin-top: 1.1rem;
      letter-spacing: 0.37px;
    }
    button:hover, button:focus {
      background: var(--btn-gradient-hover);
      box-shadow: var(--btn-shadow-hover);
      outline: none;
      color: #ff68bc;
      transform: scale(1.05);
    }
    /* Reason Section */
    .reason-swipe-container {
      margin: 0.4rem auto 0 auto;
      width: 100%;
      max-width: 520px;
      min-height: 75px;
      height: auto;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      z-index: 20;
      touch-action: pan-x;
      background: none;
    }
    .reason-card {
      position: relative;
      margin: 0 auto 0 auto;
      width: 82vw;
      max-width: 370px;
      min-width: 200px;
      min-height: 70px;
      border-radius: 1.3rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      color: #20353e;
      font-size: 1.16rem;
      font-weight: 500;
      background: radial-gradient(circle at 60% 55%, #fff6fa 0%, #ffe4ef 65%, #ffd6e3 100%);
      box-shadow: 0 10px 29px #ffeaea26, 0 1px 8px #ffd6e370;
      text-align: center;
      padding: 1.2rem 1.3rem 1.1rem 1.3rem;
      filter: drop-shadow(0 6px 12px #ffd6e322);
      transition: box-shadow 0.18s, opacity 0.16s, transform 0.4s cubic-bezier(0.66, 0.21, 0.48, 1);
      opacity: 1;
      pointer-events: all;
      will-change: transform;
    }
    .reason-card.swiping {
      box-shadow: 0 10px 32px #ffd6e3bb;
      opacity: 0.8;
      z-index: 44;
      transition: none;
    }
    .reason-card.exit-left,
    .reason-card.exit-right {
      opacity: 0;
      transition: transform 0.38s cubic-bezier(0.66, 0.21, 0.48, 1), opacity 0.27s;
    }
    .reason-card.exit-left {
      transform: translateX(-140vw) scale(0.93) rotate(-9deg);
    }
    .reason-card.exit-right {
      transform: translateX(140vw) scale(0.93) rotate(12deg);
    }
    .reason-card.entrance-right,
    .reason-card.entrance-left {
      opacity: 1;
    }
    .reason-card.entrance-right {
      transform: translateX(140vw) scale(1.01) rotate(4deg);
    }
    .reason-card.entrance-left {
      transform: translateX(-140vw) scale(1.01) rotate(-4deg);
    }
    .reason-card.show {
      opacity: 1;
      transform: scale(1) rotate(0deg);
      transition: transform 0.37s cubic-bezier(0.66, 0.21, 0.48, 1), opacity 0.21s;
      z-index: 21;
    }
    .reason-counter-below {
      margin-top: 1.4rem;
      font-size: 1rem;
      color: #cc88a2;
      font-weight: 600;
      background: rgba(255, 221, 236, 0.34);
      border-radius: 21px;
      display: inline-block;
      padding: 0.3em 1.1em;
      box-shadow: 0 3px 8px #ffb7dacc;
      letter-spacing: 0.07em;
      user-select: none;
    }
    .swipe-hint {
      font-size: 1.03rem;
      color: #e896bc;
      margin-top: 0.35rem !important;
      user-select: none;
    }
    @media (max-width: 600px) {
      .reason-card {
        width: 96vw;
        max-width: 97vw;
        padding: 1rem 0.8rem 0.7rem 0.8rem;
        font-size: 1.032rem;
        min-height: 60px;
      }
      .reason-counter-below {
        margin-top: 0.9rem;
        padding: 0.25em 1em;
      }
      .reason-swipe-container {
        min-height: 44px;
      }
      .swipe-hint {
        margin-top: 0.12rem;
      }
    }

    /* Player progress bar styling */
    .player-bar-wrap {
      width: 100%;
      max-width: 350px;
      margin: 0 auto 16px;
      position: relative;
    }
    .player-bar-bg {
      height: 10px;
      width: 100%;
      background: #ffd1ea;
      border-radius: 20px;
    }
    .player-bar {
      height: 10px;
      background: linear-gradient(90deg, #ffd1ea 0%, #ff68bc 100%);
      border-radius: 20px;
      position: absolute;
      left: 0;
      top: 0;
      width: 0;
      transition: width 0.19s cubic-bezier(0.77, 0, 0.18, 1);
    }
    .player-controls {
      display: flex;
      align-items: center;
      gap: 22px;
      justify-content: center;
      margin: 18px 0 6px 0;
    }
    .player-controls button {
      background: var(--btn-gradient);
      border: none;
      outline: none;
      font-size: 1.6rem;
      color: #b3467a;
      border-radius: 50%;
      width: 45px;
      height: 45px;
      cursor: pointer;
      transition: box-shadow 0.13s, transform 0.14s, background 0.15s;
      box-shadow: 0 2px 16px #ffd1ea88;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .player-controls button:hover {
      box-shadow: 0 6px 18px #ffb7dadc;
      background: var(--btn-gradient-hover);
      color: #ff68bc;
      transform: scale(1.08);
    }
    .player-time {
      color: #bb63a7;
      font-size: 1rem;
      display: flex;
      justify-content: center;
      gap: 8px;
      margin-bottom: 6px;
      font-variant-numeric: tabular-nums;
    }
    .music-meta {
      color: #d84fbc;
      font-size: 1.07rem;
      margin-top: 8px;
    }
    .song-art {
      width: 330px;
      height: 330px;
      border-radius: 1.1rem;
      object-fit: cover;
      box-shadow: 0 8px 20px #ffeaf5eb;
      background: #ffd1ea;
      margin-bottom: 1rem;
      max-width: 95vw;
    }
    @media (max-width: 600px) {
      .song-art {
        width: 94vw;
        height: 94vw;
      }
      .player-bar-wrap {
        max-width: 98vw;
      }
    }
  </style>
<body>
  <div id="starry-intro">
    <canvas id="stars-bg"></canvas>
    <div class="star-content">
      <div id="typing-line"></div>
      <button id="lights-btn">Turn on the Lights</button>
    </div>
  </div>

  <div class="hearts-down"></div>
  <div class="hearts-up"></div>
  <div class="confetti"></div>

  <main id="mainContent">
    <section id="home" class="page active">
      <div class="card-with-gradient-border">
        <h1>Happy Birthday, Princess! 🎈</h1>
        <p>You make my universe brighter.<br />This one's for you</p>
        <div class="nav-buttons">
          <button class="btn-continue" data-target="poem">Continue</button>
        </div>
      </div>
    </section>

    <section id="poem" class="page">
      <div class="card-with-gradient-border">
        <h2>A Poem For You</h2>
        <div class="poem-box">
          Another year rolls in and honestly I don’t even need a calendar anymore <br>
          to find an excuse to remind you,<br>
          how unfair it actually is<br>
          for one person who can look like pure chaos<br>
          and still somehow feel like the safest place I know.<br><br>

          People will just call it your birthday,<br>
          but to me it’s bigger than that,<br>
          it’s the day the universe decided to throw in,<br>
          a loud laugh, a stubborn soul,<br>
          a heart that softens when no one’s looking,<br>
          and someone who doesn’t even notice<br>
          how much light they actually carry....<br><br>

          You’re this strange kind of storm,<br>
          that doesn’t ruin anything,<br>
          you just show up, shake everything awake,<br>
          and then somehow leave it all brighter.<br>
          At the same time you’re calm enough,<br>
          to make me want to stay still,<br>
          yet wild enough to make my pulse trip over itself....<br><br>

          If laughter could wear a face, it would probably look a lot like yours,<br>
          and if mischief had a voice, it’d definitely sound like you<br>
          saying “hush” or “shush”<br>
          when you’re trying not to laugh at me....<br><br>

          So yeah Happy birthday babe— here’s to you.<br>
          To the late-night talks, the dumb jokes,<br>
          the times you tell me to hush and shush (which never really works),<br>
          and to all the moments we haven’t lived yet<br>
          that I’m already looking forward to....
        </div>
        <div class="nav-buttons">
          <button class="btn-back" data-back="home">Back</button>
          <button class="btn-continue" data-target="note">Continue</button>
        </div>
      </div>
    </section>

    <section id="note" class="page">
      <div class="card-with-gradient-border">
        <h2>Letter to the kitten</h2>
        <div class="note-box">
          It’s kind of wild and weird when I look back and realize it’s been over a year and a half since we first met.
          Just a random match, a mutual friend, and then suddenly I’m added to a GC where you were. At first it was nothing serious...
          just casual talks, formal hellos, random jokes, but then minutes turned into hours, hours into late-night convos and non-stop GC fun.
          Even after the GC drama broke things apart, we somehow stayed in touch, and those chats slowly turned into duo rank push sessions,
          the kind that made hours fly without us even noticing. Before either of us realized it, we weren’t just teammates or friends from a group,
          we were actually close...close enough to share things we never thought we’d ever tell someone we just met online.
          Like every duo, we had our fights, our arguments, but somehow we always found our way back to each other.
          Then came another round of drama, and for a while it felt like everything was over...the silence, the blocks, the ignoring, the moving on.
          No chats, no calls, no matches. Nothing. But life has this strange way of bringing people back when they’re meant to be, and somehow,
          after months apart, the universe threw us together again. And this time… it feels different. Better. Real.
          In just these few weeks we’ve become closer than ever, and yeah, we still fight, but neither of us is ready to let go so easily now.
          Looking back, through all the ups and downs, I don’t really know how you put up with me or what you see in me that makes you stay...
          but I’m glad you did. And on your birthday, all I can say is that you’ve become one of the most important people in my story.
        </div>
        <div class="nav-buttons">
          <button class="btn-back" data-back="poem">Back</button>
          <button class="btn-continue" data-target="reasons">Continue</button>
        </div>
      </div>
    </section>

    <section id="reasons" class="page">
      <div class="card-with-gradient-border">
        <h2>18 Years, 18 Reasons Why I Like You</h2>
        <div style="display:flex; flex-direction:column; align-items:center; min-height:120px;">
          <div class="reason-swipe-container" id="reasonSwipeContainer"></div>
          <div class="reason-counter-below" id="reasonCounter"></div>
          <div class="swipe-hint">Swipe!</div>
        </div>
        <div class="nav-buttons" id="reasonsNavBtns" style="margin-top:2.4rem; display:none;">
          <button class="btn-back" data-back="note">Back</button>
          <button class="btn-continue" data-target="playlist">Continue</button>
        </div>
      </div>
    </section>

    <section id="playlist" class="page">
      <div class="card-with-gradient-border">
        <h2>A Birthday Playlist For You</h2>
        <iframe class="playlist-embed"
          src="https://open.spotify.com/embed/playlist/226Z01QV5foj352H9q7ZeT"
          allowtransparency="true"
          allow="encrypted-media"
          title="playlist"
          height="480"></iframe>
        <div class="nav-buttons">
          <button class="btn-back" data-back="reasons">Back</button>
          <button class="btn-continue" data-target="song">Continue</button>
        </div>
      </div>
    </section>

    <section id="song" class="page">
      <div class="card-with-gradient-border">
        <h2>Our Song?</h2>
        <div class="music-player">
          <img src="https://www.dropbox.com/scl/fi/qjn6ysnjd9r2mj4dkes18/albumcover.png?rlkey=fb69ptlgo6sgq55ednfukk6sy&st=yp0lbjcw&raw=1"
            alt="Song Art" class="song-art" />
          <div class="music-meta">Made by me for you</div>
          <div class="player-bar-wrap">
            <div class="player-bar-bg"></div>
            <div class="player-bar" id="progress-bar"></div>
          </div>
          <div class="player-time">
            <span id="current-time">00:00</span> / <span id="duration">00:00</span>
          </div>
          <div class="player-controls">
            <button id="play-pause">&#9658;</button>
            <button id="restart">&#x21ba;</button>
          </div>
          <audio id="audio">
            <source src="https://www.dropbox.com/scl/fi/niz2vhyk5ugqgn7yklgsx/Back-to-You.mp3?rlkey=pgbtoxzpieuvgru7yn2gno96v&st=e9g8g1cz&dl=1" type="audio/mp3" />
            Sorry, your browser does not support audio.
          </audio>
        </div>
        <div class="nav-buttons">
          <button class="btn-back" data-back="playlist">Back</button>
          <button class="btn-continue" data-target="final">Continue</button>
        </div>
      </div>
    </section>

    <section id="final" class="page">
      <div class="card-with-gradient-border final-box">
        <h2>At Last <span style="font-size:1.5em;">🌟</span></h2>
        <div>
          Hope you loved this little surprise!<br />
          May this year be crazier, happier, and filled with more (me) moments.<br />
          <span style="color:#ff68bc; font-size:1.35em; font-weight:600;">So… that’s all, Princess. Just a little piece of my heart wrapped up for you. Happy Birthday... now stop blushing and go enjoy your day!!</span>
        </div>
        <div class="gift-row">
          <span>🎁</span><span>🥳</span>
        </div>
        <div class="final-gift-msg">You deserve all the best vibes! ✨</div>
        <div class="nav-buttons" style="margin-top: 2rem;">
          <button class="btn-back" data-back="song">Back</button>
        </div>
      </div>
    </section>
  </main>

  <script>
    (function drawStars() {
      const cvs = document.getElementById("stars-bg");
      function resize() {
        cvs.width = window.innerWidth;
        cvs.height = window.innerHeight;
      }
      resize();
      window.addEventListener("resize", resize);
      const ctx = cvs.getContext("2d");
      const starCount = 120;
      const stars = [];
      for (let i = 0; i < starCount; i++) {
        stars.push({
          x: Math.random() * cvs.width,
          y: Math.random() * cvs.height,
          r: Math.random() * 1.7 + 0.5,
          o: Math.random() * Math.PI * 2,
          blinkSeed: Math.floor(Math.random() * 3100),
        });
      }
      function animate() {
        ctx.clearRect(0, 0, cvs.width, cvs.height);
        const now = performance.now() / 1000;
        for (let i = 0; i < stars.length; i++) {
          const s = stars[i];
          let t = now * (1.18 + Math.sin(s.blinkSeed % 7) / 12) + (s.blinkSeed % 13);
          let alpha = 0.55 + 0.45 * Math.abs(Math.sin(t + s.blinkSeed)) ** 2.3;
          ctx.save();
          ctx.globalAlpha = alpha;
          ctx.beginPath();
          ctx.arc(s.x, s.y, s.r, 0, Math.PI * 2);
          ctx.fillStyle = "#fffbe9";
          ctx.shadowColor = "#ffffff";
          ctx.shadowBlur = 4 + s.r * 2.8;
          ctx.fill();
          ctx.restore();
        }
        requestAnimationFrame(animate);
      }
      animate();
    })();

    const line = "A wish under a million stars, made just for you.";
    const typingLine = document.getElementById("typing-line");
    const lightsBtn = document.getElementById("lights-btn");
    let t = 0;
    function typeLine() {
      if (t <= line.length) {
        typingLine.innerHTML =
          line.slice(0, t) + "<span style='border-right:2.5px solid #fff;opacity:0.7'></span>";
        t++;
        setTimeout(typeLine, 30 + Math.random() * 40);
      } else {
        typingLine.innerHTML = "<span style='white-space:pre-line'>" + line + "</span>";
        setTimeout(() => {
          lightsBtn.style.display = "inline-block";
          setTimeout(() => {
            lightsBtn.style.opacity = 1;
          }, 90);
        }, 210);
      }
    }
    setTimeout(typeLine, 400);

    function spawnHeartsDown(n) {
      const layer = document.querySelector(".hearts-down");
      layer.innerHTML = "";
      const vw = Math.max(document.documentElement.clientWidth, window.innerWidth);
      const colorClasses = ["pink", "teal", "violet"];
      for (let i = 0; i < n; i++) {
        let left = Math.random() * (vw - 40);
        let delay = (Math.random() * 8).toFixed(2);
        let color = colorClasses[i % colorClasses.length];
        let heartElem = document.createElement("div");
        heartElem.className = "heart-down " + color;
        heartElem.style.left = left + "px";
        heartElem.style.animationDelay = delay + "s";
        heartElem.innerHTML =
          '<svg viewBox="0 0 32 32"><path d="M23.8,4.3c-2.3,0-4.4,1.2-5.8,3.1C16.6,5.5,14.5,4.3,12.2,4.3C8.4,4.3,5.5,7.3,5.5,11.1c0,6.7,11.2,14.3,11.7,14.6c0.3,0.2,0.7,0.2,1,0c0.5-0.3,11.7-7.9,11.7-14.6C28.5,7.3,25.6,4.3,23.8,4.3z"/></svg>';
        layer.appendChild(heartElem);
      }
    }
    function spawnHeartsUp(n) {
      const layer = document.querySelector(".hearts-up");
      layer.innerHTML = "";
      const vw = Math.max(document.documentElement.clientWidth, window.innerWidth);
      const colorClasses = ["pink", "teal", "violet"];
      for (let i = 0; i < n; i++) {
        let left = Math.random() * (vw - 40);
        let delay = (Math.random() * 8).toFixed(2);
        let color = colorClasses[i % colorClasses.length];
        let heartElem = document.createElement("div");
        heartElem.className = "heart-up " + color;
        heartElem.style.left = left + "px";
        heartElem.style.animationDelay = delay + "s";
        heartElem.innerHTML =
          '<svg viewBox="0 0 32 32"><path d="M23.8,4.3c-2.3,0-4.4,1.2-5.8,3.1C16.6,5.5,14.5,4.3,12.2,4.3C8.4,4.3,5.5,7.3,5.5,11.1c0,6.7,11.2,14.3,11.7,14.6c0.3,0.2,0.7,0.2,1,0c0.5-0.3,11.7-7.9,11.7-14.6C28.5,7.3,25.6,4.3,23.8,4.3z"/></svg>';
        layer.appendChild(heartElem);
      }
    }
    function spawnConfetti(n) {
      const layer = document.querySelector(".confetti");
      layer.innerHTML = "";
      const vw = Math.max(document.documentElement.clientWidth, window.innerWidth);
      const colors = ["#fff5fa", "#ffd1ea", "#ffb7da", "#64ffe7", "#8f8cff"];
      for (let i = 0; i < n; i++) {
        let left = Math.random() * (vw - 14);
        let top = (Math.random() * -50).toFixed(0);
        let r = Math.random() * 360;
        let dur = 3 + Math.random() * 3;
        let c = colors[Math.floor(Math.random() * colors.length)];
        let piece = document.createElement("div");
        piece.className = "confetti-piece";
        piece.style.left = left + "px";
        piece.style.top = top + "px";
        piece.style.background = c;
        piece.style.transform = `rotate(${r}deg)`;
        piece.style.animationDuration = dur + "s";
        layer.appendChild(piece);
      }
    }
    function activateHeartsAndConfetti() {
      spawnHeartsDown(20);
      spawnHeartsUp(20);
      spawnConfetti(28);
      window.addEventListener("resize", () => {
        spawnHeartsDown(20);
        spawnHeartsUp(20);
        spawnConfetti(28);
      });
    }
    lightsBtn.onclick = function () {
      const intro = document.getElementById("starry-intro");
      intro.style.transition = "opacity 1.15s";
      intro.style.opacity = 0;
      setTimeout(() => {
        intro.style.display = "none";
        document.getElementById("mainContent").style.display = "flex";
        activateHeartsAndConfetti();
        document.querySelectorAll(".page").forEach((p) => p.classList.remove("active"));
        document.getElementById("home").classList.add("active");
      }, 1150);
    };

    const reasons = [
      "You make every room brighter.",
      "Your laugh is contagious.",
      "You’re smart (and you know it too but sometimes you are dumb.).",
      "You give the best advice even when I don’t take it.",
      "You’re stubborn in a way that makes me care even more.",
      "You’re my favorite distraction.",
      "You vibe with my weird.",
      "You don’t even realize how much light you bring into my life",
      "You’re the first person I want to tell things to, good or bad..",
      "Your taste in music.",
      "You make me want to be my best self.",
      "You’re the first person to make me write and do all this.",
      "You always know when I need a hug or a hype up.",
      "You’re unapologetically yourself.",
      "You’re honest.",
      "You love fiercely—when you care, you show it.",
      "You’re not perfect, but you’re real and that means more",
      "And simply… because it’s you. No one else could ever be.",
    ];

    const reasonSwipeContainer = document.getElementById("reasonSwipeContainer");
    const reasonCounter = document.getElementById("reasonCounter");
    const reasonsNavBtns = document.getElementById("reasonsNavBtns");
    let currentReason = 0;
    let swipeDisabled = false;
    let visitedReasons = new Set();

    function showReason(index, direction) {
      if (swipeDisabled) return;
      swipeDisabled = true;
      if (reasonSwipeContainer) {
        reasonSwipeContainer.innerHTML = "";
        const card = document.createElement("div");
        card.className = "reason-card show";
        card.innerHTML = `<span>${reasons[index]}</span>`;
        reasonSwipeContainer.appendChild(card);
        if (direction === "left" || direction === "right") {
          card.classList.add(direction === "right" ? "entrance-right" : "entrance-left");
          setTimeout(() => {
            card.classList.remove("entrance-right", "entrance-left");
            card.classList.add("show");
          }, 30);
        }
        setTimeout(() => {
          swipeDisabled = false;
        }, 390);
        if (reasonCounter) {
          reasonCounter.innerHTML = ` ${index + 1} <span style="opacity:0.7;font-weight:500;">/</span> 18 `;
        }
        visitedReasons.add(index);
        if (reasonsNavBtns) {
          reasonsNavBtns.style.display = visitedReasons.size === reasons.length ? "" : "none";
        }
      }
    }

    function nextReason() {
      if (swipeDisabled) return;
      const card = reasonSwipeContainer.querySelector(".reason-card");
      if (card) {
        card.classList.add("exit-right");
        setTimeout(() => {
          currentReason = (currentReason + 1) % reasons.length;
          showReason(currentReason, "right");
        }, 350);
      }
    }

    let startX = null;
    reasonSwipeContainer.addEventListener("touchstart", function (e) {
      if (swipeDisabled) return;
      startX = e.touches[0].clientX;
    });
    reasonSwipeContainer.addEventListener("touchmove", function (e) {
      if (startX === null || swipeDisabled) return;
      let dx = e.touches[0].clientX - startX;
      const card = reasonSwipeContainer.querySelector(".reason-card");
      if (card) {
        card.classList.add("swiping");
        card.style.transform = `translateX(${dx}px) scale(0.99) rotate(${dx / 25}deg)`;
      }
    });
    reasonSwipeContainer.addEventListener("touchend", function (e) {
      if (swipeDisabled) return;
      const card = reasonSwipeContainer.querySelector(".reason-card");
      if (!card) return;
      card.classList.remove("swiping");
      card.style.transform = "";
      if (!startX) return;
      let dx = e.changedTouches[0].clientX - startX;
      if (Math.abs(dx) > 40) {
        nextReason();
      }
      startX = null;
    });
    let mouseStartX = null;
    reasonSwipeContainer.addEventListener("mousedown", function (e) {
      if (swipeDisabled) return;
      mouseStartX = e.clientX;
      document.body.style.userSelect = "none";
    });
    document.addEventListener("mousemove", function (e) {
      if (mouseStartX === null || swipeDisabled) return;
      let dx = e.clientX - mouseStartX;
      const card = reasonSwipeContainer.querySelector(".reason-card");
      if (card) {
        card.classList.add("swiping");
        card.style.transform = `translateX(${dx}px) scale(0.99) rotate(${dx / 25}deg)`;
      }
    });
    document.addEventListener("mouseup", function (e) {
      if (mouseStartX === null || swipeDisabled) return;
      const card = reasonSwipeContainer.querySelector(".reason-card");
      if (!card) return;
      card.classList.remove("swiping");
      card.style.transform = "";
      let dx = e.clientX - mouseStartX;
      if (Math.abs(dx) > 40) {
        nextReason();
      }
      mouseStartX = null;
      document.body.style.userSelect = "";
    });

    function animateReasons() {
      showReason(currentReason);
    }

    function showPage(id) {
      document.querySelectorAll(".page").forEach((p) => p.classList.remove("active"));
      document.getElementById(id).classList.add("active");
      window.scrollTo(0, 0);
      if (id === "reasons") {
        visitedReasons = new Set([currentReason]);
        if (reasonsNavBtns) reasonsNavBtns.style.display = "none";
        animateReasons();
      }
    }

    document.querySelectorAll(".btn-continue").forEach((btn) => {
      btn.onclick = function () {
        showPage(this.getAttribute("data-target"));
      };
    });

    document.querySelectorAll(".btn-back").forEach((btn) => {
      btn.onclick = function () {
        showPage(this.getAttribute("data-back"));
      };
    });

    // Music player
    const audio = document.getElementById("audio");
    const playBtn = document.getElementById("play-pause");
    const restartBtn = document.getElementById("restart");
    const currentTimeElem = document.getElementById("current-time");
    const durationElem = document.getElementById("duration");
    const playerBar = document.getElementById("progress-bar");

    function formatTime(seconds) {
      if (!seconds || isNaN(seconds)) return "00:00";
      let m = Math.floor(seconds / 60);
      let s = Math.floor(seconds % 60);
      if (m < 10) m = "0" + m;
      if (s < 10) s = "0" + s;
      return m + ":" + s;
    }

    if (audio) {
      audio.addEventListener("loadedmetadata", () => {
        durationElem.textContent = formatTime(audio.duration);
      });

      audio.addEventListener("timeupdate", () => {
        currentTimeElem.textContent = formatTime(audio.currentTime);
        let pct = (audio.currentTime / audio.duration) * 100 || 0;
        playerBar.style.width = pct + "%";
      });

      playBtn.addEventListener("click", () => {
        if (audio.paused) {
          audio.play();
          playBtn.innerHTML = "&#10073;&#10073;";
        } else {
          audio.pause();
          playBtn.innerHTML = "&#9658;";
        }
      });

      audio.addEventListener("ended", () => {
        playBtn.innerHTML = "&#9658;";
      });

      restartBtn.addEventListener("click", () => {
        audio.currentTime = 0;
        audio.play();
        playBtn.innerHTML = "&#10073;&#10073;";
      });

      playerBar.parentElement.addEventListener("click", function (e) {
        const rect = playerBar.parentElement.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const pct = x / rect.width;
        audio.currentTime = audio.duration * pct;
      });
    }
  </script>
</body>
</html>

